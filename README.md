# DigitalProteins

This repository contains the code and data for the short paper titled "EvoDesign: a genetic algorithm for designing Digital Cyclic Petides", which was submitted to the GEM-2025 workshop of the ICLRâ€™25.

This repository is organized as follows:

- `cyclic_peptides_dataset`: contains the PDB files of the cyclic peptide structures used as design targets in the benchmark.
- `esmif_solutions`: contains CSV files storing all sequences generated by ESM-IF1 and their metric values.
- `proteinmpnn_solutions`: contains CSV files storing all sequences generated by ProteinMPNN.
- `evodesign_solutions`: contains CSV files storing the sequences produced by the EvoDesign.
- `evodesign_code`: contains the scripts for running the EvoDesign algorithm.
- `initial_settings`: contains the RNG configuration to replicate the results presented in the paper for PDB structures in the `cyclic_peptides_dataset` folder.

### Installation requirements

The following packages are required to run EvoDesign; these packages can be install easily with [Anaconda](https://www.anaconda.com/):

- [NumPy](https://numpy.org/install/).
- [BioPython](https://biopython.org/wiki/Packages).
- [Pandas](https://pypi.org/project/pandas/).
- [Matplotlib](https://matplotlib.org/stable/users/getting_started/index.html#installation-quick-start).
- [SciPy](https://scipy.org/install/#pip-install).

External components used by EvoDesign must be installed separately. Installation instructions for these can be found in the following links:

- [ESMFold](https://github.com/facebookresearch/esm).
- [PyRosetta](https://www.pyrosetta.org/downloads#h.iwt5ktel05jc).

### Usage

To run EvoDesign and replicate the results presented in the paper, you must run the `evodesign_code/run_experiments_single_thread.py` script. 
Use the following commands for the "short" peptides:

```bash
$ python3 run_experiments_single_thread.py short \
                                           0 -l 12 \
                                           -e 3 \
                                           -a rmsd_gdt_tm_cm_cyc_eng_plddt \
                                           -w 0.5,0.0,0.0,0.0,0.5,0.0,0.0 \
                                           -p http://127.0.0.1:8000/esmfol0d 
                                           -g 225
```

The command for "long" sequences is:

```bash
$ python3 run_experiments_single_thread.py long \
                                           24 -l 15 \
                                           -e 3 \
                                           -a rmsd_gdt_tm_cm_cyc_eng_plddt \
                                           -w 0.0,0.33,0.0,0.33,0.34,0.0,0.0 \
                                           -p http://127.0.0.1:8000/esmfol0d \
                                           -g 225
```

Here's the explanation for each parameter and flag used in these commands:

- The first parameter (`short` and `long` in the commands described above) indicates the name of the `run_experiments_single_thread.py` instance being executed. This is necessary when multiple instances of this script are executed in parallel, so that the results of one instance do not overwrite the results of the other.
- The next two parameters indicate the indices of the PDB structures in the cyclic peptides dataset that EvoDesign will used as design targets. For "short" peptides, the parameters `0 -l 12` indiceate that the target structures are first 12 structures in the dataset. For "long" peptides, the parameters `24 -l 15` indicate that the target structures start at index position 24 and will continue for the next 14 consecutive structures. The original dataset consisted of 39 structures, but only 27 were used in the paper.
- The `-e 3` flag indicates that EvoDesign will be executed three times for each target PDB structure.
- The `-a rmsd_gdt_tm_cm_cyc_eng_plddt` declare the components of the fitness function. And the flag `-w` is used to declare the weights for each component. For "short" peptides, the weights were `-w 0.5,0.0,0.0,0.0,0.5,0.0,0.0 -p`, and for "long" peptides these were `-w 0.0,0.33,0.0,0.33,0.34,0.0,0.0`.
- The `-g 225` flag indicates that EvoDesign will be executed for 225 generations.
- The `-p http://127.0.0.1:8000/esmfold` flag is used to indicate the URL of the running ESMFold server. ESMFold can be executed in a local server using Gunicorn by running the `evodesign_code/local_api_esmfold.py` script. This is useful to allow multiple instances of the `run_experiments_single_thread.py` script to all use the same ESMFold instance to make predictions.

To replicate the results of these experiments, make sure navigate to the `initial_settings` folder before running these commands. The `initial_settings` folder contain the configuration of the RNG for each EvoDesign experiments presented in the paper. 
